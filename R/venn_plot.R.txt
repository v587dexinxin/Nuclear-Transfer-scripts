x[,0]
a <- x[,0]
View(a)
View(x)
a <- x[,1]
View(a)
a <- x[,2]
View(a)
a <- x[,1]
View(a)
x[1:2]
x[c('ivf1c_1' , 'ivf2c_1')]
a <- x[c('ivf1c_1' , 'ivf2c_1')]
View(a)
fisher.test(a)
m <- matrix(sample(1:24,24,T),ncol=4)
m
m <- matrix(sample(1:24,24,T),ncol=2)
m
fisher.test(m)
sample(1:24,24,T)
m <- matrix(sample(1:24,2400,T),ncol=2)
fisher.test(m)
m <- matrix(sample(1:24,100,T),ncol=2)
fisher.test(m)
m <- matrix(sample(1:24,1000,T),ncol=2)
fisher.test(m)
m <- matrix(sample(1:24,1000,T),ncol=2,workspace = 200000)
TeaTasting <-
matrix(c(3, 1, 1, 3),
nrow = 2,
dimnames = list(Guess = c("Milk", "Tea"),
Truth = c("Milk", "Tea")))
View(TeaTasting)
fisher.test(TeaTasting, alternative = "greater")
TeaTasting <-
matrix(c(3, 1, 1, 3),
nrow = 2,
dimnames = list(Guess = c("Milk", "Tea"),
Truth = c("Milk", "Tea")))
fisher.test(TeaTasting, alternative = "greater")
Job <- matrix(c(1,2,1,0, 3,3,6,1, 10,10,14,9, 6,7,12,11), 4, 4,
dimnames = list(income = c("< 15k", "15-25k", "25-40k", "> 40k"),
satisfaction = c("VeryD", "LittleD", "ModerateS", "VeryS")))
View(Job)
fisher.test(Job)
n1=6426
n2=1462
n3=1034
n4=389
n12=287
n13=377
n14=141
n23=268
n24=146
n34=168
n123=394
n124=117
n134=148
n234=314
n1234=907
area1=6426
area2=1462
area3=1034
area4=389
n12=287
n13=377
n14=141
n23=268
n24=146
n34=168
n123=394
n124=117
n134=148
n234=314
n1234=907
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
library('VennDiagram')
install.packages('VennDiagram')
install.packages("VennDiagram")
library('VennDiagram')
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=6426
area2=3167
area3=3442
area4=2330
n12=287
n13=377
n14=141
n23=268
n24=146
n34=168
n123=394
n124=117
n134=148
n234=314
n1234=907
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=6426
area2=3167
area3=3442
area4=2330
n12=1705
n13=1826
n14=1313
n23=1883
n24=846
n34=1537
n123=1301
n124=1024
n134=1055
n234=1221
n1234=907
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=6426
area2=3167
area3=3442
area4=2330
n12=1705
n13=1826
n14=1313
n23=1883
n24=846
n34=1537
n123=1301
n124=1024
n134=1055
n234=1221
n1234=907
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=6426
area2=3167
area3=3442
area4=2330
n12=1705
n13=1826
n14=1313
n23=1883
n24=1484
n34=1537
n123=1301
n124=1024
n134=1055
n234=1221
n1234=907
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=5059
area2=1304
area3=1624
area4=1189
n12=831
n13=1003
n14=750
n23=805
n24=705
n34=732
n123=606
n124=530
n134=553
n234=560
n1234=450
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=3567
area2=1479
area3=1600
area4=1053
n12=714
n13=811
n14=551
n23=815
n24=650
n34=661
n123=525
n124=416
n134=437
n234=528
n1234=370
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=3564
area2=1478
area3=1602
area4=1051
n12=671
n13=764
n14=521
n23=786
n24=617
n34=644
n123=503
n124=389
n134=416
n234=506
n1234=348
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=2474
area2=439
area3=570
area4=416
n12=247
n13=318
n14=235
n23=242
n24=219
n34=233
n123=163
n124=151
n134=163
n234=165
n1234=120
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=4419
area2=1478
area3=1827
area4=1319
n12=757
n13=907
n14=683
n23=863
n24=753
n34=770
n123=551
n124=489
n134=501
n234=605
n1234=416
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
area1=3163
area2=1030
area3=1214
area4=802
n12=569
n13=649
n14=447
n23=642
n24=518
n34=533
n123=430
n124=339
n134=358
n234=433
n1234=302
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
library(VennDiagram)
install.packages("VennDiagram")
install.packages("VennDiagram")
library(VennDiagram)
library(grid)
library(futile.logger)
library(VennDiagram)
area1=3163
area2=1030
area3=1214
area4=802
n12=569
n13=649
n14=447
n23=642
n24=518
n34=533
n123=430
n124=339
n134=358
n234=433
n1234=302
draw.quad.venn(area1, area2, area3, area4, n12, n13, n14, n23, n24,n34, n123, n124, n134, n234, n1234,category = c("CCS", "NT5", "NT6", "fESC"),fill = c("orange", "red", "green", "blue"),lty = "dashed",cex = 2,cat.cex = 2,cat.col = c("orange", "red", "green", "blue"))
library('DESeq2')
install.packages("DESeq2")
source("https://bioconductor.org/biocLite.R")
biocLite("DESeq2")
biocLite("DESeq2")
library('DESeq2')
install.packages("RCurl")
install.packages("RCurl")
library('DESeq2')
install.packages("GenomeInfoDb")
library('DESeq2')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
install.packages("BiocManager")
BiocManager::install("GenomeInfoDb", version = "3.8")
library('GenomeInfoDb')
install.packages("RCurl")
library('GenomeInfoDb')
library('DESeq2')
library('ggplot2')
install.packages("ggplot2")
library('ggplot')
library('ggplot2')
library('ggplot2')
library("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
library("ggplot2")
install.packages("ggplot2")
library("ggplot2")
install.packages("ggplot2")
librar('DESeq2')
library('DESeq2')
library('DESeq2')
install.packages("ggplot2")
install.packages("rlang")
install.packages("ggplot2")
install.packages("rlang")
install.packages("ggplot2")
update.packages("rlang")
library(rlang)
library('DESeq2')
install.packages('DESeq2')
source("https://bioconductor.org/biocLite.R")
biocLite("DESeq2")
library('DESeq2')
library('DESeq2')
directory <- 'D:\Workspace_New\data\RNA\reads_count'
directory <- 'D:\Workspace_New\data\RNA\reads_count'
directory<-'D:\Workspace_New\data\RNA\reads_count'
directory<-'D:/Workspace_New/data/RNA/reads_count'
sampleFiles<-grep('reads_count',list.files(directory),value = TRUE)
sampleFiles
directory<-'D:/Workspace_New/data/RNA/reads_count/'
sampleFiles<-grep('reads_count',list.files(directory),value = TRUE)
sampleFiles
sampleCondition<-c('CCS','CCS','CCS','NT5','NT5','NT5','NT5','NT6','NT6','NT6','fESC','fESC','fESC')
sampleCondition
sampleFiles<-grep('.txt',list.files(directory),value = TRUE)
sampleFiles
sampleFiles<-grep('.txt',list.files(directory),value = TRUE)
sampleFiles
sampleCondition<-c('CCS','CCS','CCS','fESC','fESC','fESC','NT5','NT5','NT5','NT5','NT6','NT6','NT6')
sampleCondition
sampleTable<-data.frame(sampleName=sampleFiles , fileName=sampleFiles , condition=sampleCondition)
sampleTable
n = grep('CCS',sampleTable)
n
sampleTable
a = sampleTable$condition
a
n = grep('CCS',a)
n
n = grep('NT',a)
n
all = c(n)
all
n = grep('CCS',sampleTable)
b
n
a = sampleTable$condition
a
a
n = grep('CCS',a)
n
n = grep('NT',a)
n
all = c(n)
all
sampleTable_1 = sampleTable[-all,]
sampleTable_1
sampleTable[-all,]
sampleTable[-all]
sampleTable_1
n = grep('fESC',a)
m = grep('NT6' , a)
m
n
all = c(m , n)
all
sampleTable_2 = sampleTable[-all,]
sampleTable_2
n = grpe('CCS',sampleTable)
n = grep('CCS',sampleTable)
m = grep('NT6' , sampleTable)
n
m
a
n = grep('CCS',a)
m = grep('NT6' , a)
all = c(n , m)
all
sampleTable_3 = sampleTable[all,]
sampleTable_3
n = grep('fESC',a)
m = grep('NT5' , a)
all = c(n , m)
sampleTable_4 = sampleTable[all,]
sampleTable_4
m = grep('NT6' , a)
all = c(n , m)
sampleTable_5 = sampleTable[all,]
sampleTable_5
n = grep('NT5',a)
m = grep('NT6',a)
all = c(n , m)
sampleTable_6 = sampleTable[all,]
sampleTable_6
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = )
database_all <- read.table(file = "readcount", sep = "\t", header = T, row.names = 1)
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~sampleCondition)
sampleCondition
sampleTable_1
sampleCondition[1,2,3,4,5,6]
all
all = c(1,2,3,4,5,6)
all
sampleCondition[all]
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~sampleCondition[all])
sampleTable_1
type <- factor(c(rep("LC_1",3), rep("LC_2",3)))
type
sampleCondition
type_1 <- factor(c(rep("CCS",3), rep("fESC",3)))
type_1
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~type_1)
sampleTable_1
sampleTable_1$fileName
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1$fileName , directory = directory , design = ~type_1)
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~condition)
sampleTable_1
directory
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~condition)
sampleCondition
sampleTable$condition
sampleTable_1$condition
sampleTable_1$sampleName
sampleFiles
sampleFiles <- c("CCS_R1.txt" , "CCS_R2.txt" , "CCS_R3.txt" , "fESC_R1.txt" , "fESC_R2.txt" , "fESC_R3.txt")
sampleFiles
sampleCondition <- c('CCS' , 'CCS' , 'CCS' , 'fESC' , 'fESC' , 'fESC')
sampleCondition
sampleTable <- data.frame(sampleName = sampleFiles , fileName = sampleFiles , condition = sampleCondition)
sampleTable
sampleTable$sampleName
sampleTable$fileName
sampleTable$condition
sampleTable_1 <- data.frame(sampleName = sampleFiles , fileName = sampleFiles , condition = sampleCondition)
sampleTable_1
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~condition)
directory
condition
sampleTable_1 <- data.frame(fileName = sampleFiles , condition = sampleCondition)
sampleTable_1
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~condition)
sampleTable_1 <- data.frame(sampleName = sampleFiles , fileName = sampleFiles , condition = sampleCondition)
sampleTable_1
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~condition)
sampleTable_1$condition
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~3)
condition <- factor(c(rep("LC_1",3), rep("LC_2",3)))
coldata <- data.frame(condition , condition)
coldata
coldata$condition
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~condition)
sampleTable_1$condition
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable_1 , directory , design = ~condition)
sampleTable_1$condition
sampleTable_1
library('DESeq2')
library('DESeq2')
directory <- 'D:/Workspace_New/data/RNA/reads_count/'
sampleFiles <- c('CCS_R1.txt' , 'CCS_R2.txt' , 'CCS_R3.txt', 'fESC_R1.txt', 'fESC_R2.txt', 'fESC_R3.txt')
sampleCondition <- c('CCS' , 'CCS' , 'CCS' , 'fESC' , 'fESC' ,'fESC')
sampleTable_1 <- data.frame(sampleName = sampleFiles , fileName = sampleFiles , condition = sampleCondition)
sampleTable_1
ddsHTseq1 <- DESeqDataSetFromHTSeqCount(sampleTable = sampleTable_1 , directory = directory , design = ~condition)
directory <- systme.file("extdata", package = "pasilla", mustWork =TRUE)
sampleTable_1$condition
database_all <- read.table(file = "D:/Workspace_New/data/RNA/reads_count/merged.csv", sep = ",", header = T, row.names = 1)
database_all <- read.table(file = "D:/Workspace_New/data/RNA/reads_count/merged.csv", sep = ",", header = T)
View(database_all)
database <- database_all[,1:6]
database
database <- database_all[,2:7]
database
type <- factor(c(rep("CCS",3), rep("NT5",3)))
database_all <- read.table(file = "D:/Workspace_New/data/RNA/reads_count/merged.csv", sep = ",", header = T)
database <- database_all[,2:7]
type <- factor(c(rep("CCS",3), rep("NT5",3)))
condition <- factor(c(rep("LC_1",3), rep("LC_2",3)))
coldata <- data.frame(row.names = colnames(database), condition)
dds <- DESeqDataSetFromMatrix(countData=database, colData=coldata, design=~condition)
dds
dss1 <- DESeq(dds)
res <- results(dds1)
dds1 <- DESeq(dds)
res <- results(dds1)
res
type <- factor(c(rep("CCS",3), rep("NT5",3)))
type <- factor(c(rep("CCS",3), rep("NT5",4)))
database_all <- read.table(file = "D:/Workspace_New/data/RNA/reads_count/merged.csv", sep = ",", header = T)
database <- database_all[,2:8]
database
colnames(database)
coldata <- data.frame(row.names = colnames(database), condition)
coldata <- data.frame(row.names = colnames(database), type)
coldata
library('DESeq2')
dds <- DESeqDataSetFromMatrix(countData=database, colData=coldata, design=~type)
dds
dds1 <- DESeq(dds)
res <- results(dds1)
res
res <- res[order(res$padj),]
res
head(res)
result <- c(res , database)
result
result
pwd
write.csv(result , 'D:\\Workspace_New\\data\\RNA\\diff_expression\\CCS_NT5.csv')
write.csv(res , 'D:\\Workspace_New\\data\\RNA\\diff_expression\\CCS_NT5.csv')
res
savehistory("C:/Users/Administrator/Desktop/r.txt")


area1=12325
area2=12325
area3=12325
n12=11941
n13=11607
n23=11859
n123=11541
draw.triple.venn(area1, area2, area3 , n12, n23, n13, n123, category = c("Haploid", "HiCHap", "SNP-bias uncorrected"),fill = c("red", "green", "orange"),lty = "dashed",cex = 2,cat.cex = 2)


